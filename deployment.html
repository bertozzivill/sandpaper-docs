<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- START: inst/pkgdown/templates/head.html --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="last-modified" content="2021-12-28 00:14:29 +0000"><title>Introduction to the New Lesson Template: Lesson Deployment</title><link rel="apple-touch-icon-precomposed" sizes="57x57" href="favicons/cp/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="favicons/cp/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="favicons/cp/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="favicons/cp/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="favicons/cp/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="favicons/cp/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="favicons/cp/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="favicons/cp/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="favicons/cp/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="favicons/cp/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="favicons/cp/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="favicons/cp/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="favicons/cp/favicon-128.png" sizes="128x128"><meta name="application-name" content="The Carpentries - Introduction to the New Lesson Template"><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="favicons/cp/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="favicons/cp/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="favicons/cp/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="favicons/cp/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="favicons/cp/mstile-310x310.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><!--carpentries--><link href="css/syntax.css" rel="stylesheet"><link href="css/lesson.css" rel="stylesheet"><script src="js/lesson.js"></script><meta property="og:title" content="Lesson Deployment"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- END:   inst/pkgdown/templates/head.html--></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header><!-- START: inst/pkgdown/templates/navbar.html --><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Home</a>
        <a class="external-link navbar-link" href="https://carpentries.github.io/sandpaper-docs/" aria-label="Lesson Infrastructure is in the testing phase. Read on for more information." title="Lesson Infrastructure is in the testing phase.">🚧</a>
        <!-- TODO: the logo is not centered in the nav bar and looks ugly... also there needs to be a better way of choosing the logo... probably on the R side.-->
        <a href="https://carpentries.org" class="external-link pull-left">
          <img class="navbar-logo" src="img/cp-icon-blue.svg" alt="The Carpentries logo"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="CODE_OF_CONDUCT.html">Code of Conduct</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Episodes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="introduction.html">Introduction to the New Template</a>
    </li>
    <li>
      <a href="episodes.html">Episode Structure</a>
    </li>
    <li>
      <a href="editing.html">Editing a {sandpaper} lesson</a>
    </li>
    <li>
      <a href="example.html">EXAMPLE: Using RMarkdown</a>
    </li>
    <li>
      <a href="deployment.html">Lesson Deployment</a>
    </li>
    <li>
      <a href="update.html">Maintaining a Healthy Infrastructure</a>
    </li>
    <li>
      <a href="pull-request.html">Auditing Pull Requests</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    For Learners
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="setup.html">Setup</a>
    </li>
    <li>
      <a href="github-pat.html">Setting Up a Personal Access Token via R</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    For Instructors
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="notes.html">Instructor Notes</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learner Profiles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="maintainer.html">Maintainer Profiles</a>
    </li>
    <li>
      <a href="instructor.html">Instructor Profiles</a>
    </li>
  </ul></li>
<li>
  <a href="LICENSE.html">License</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

      <!--START: inst/pkgdown/templates/header.html-->


    <div class="panel panel-default life-cycle">
      <div id="life-cycle" class="panel-body pre-alpha">
         This lesson is still being designed and assembled (Pre-Alpha version) 
        
        
      </div>
    </div>


<!--END  : inst/pkgdown/templates/header.html-->

      </header><!-- START: inst/pkgdown/templates/content-title-body.html --><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Lesson Deployment</h1>
    </div>

<div class="section level2 objectives">
<h2>Overview</h2>
<div class="row">
<div class="col-md-3">
<p><strong>Teaching: </strong> 5<br><strong>Exercises: </strong> 0</p>
</div>
<div class="col-md-9">
<p><strong>Questions</strong></p>
<ul><li>What is the two-step model of deployment?</li>
<li>Why do we preserve both generated markdown and HTML?</li>
</ul></div>
</div>
<div class="row">
<div class="col-md-3">

</div>
<div class="col-md-9">
<p><strong>Objectives</strong></p>
<ul><li>Understand the two-step model for lesson deployment</li>
<li>Understand how our lessons are deployed on GitHub</li>
</ul></div>
</div>
</div>
<div class="section level2">
<h2 id="building-a-lesson">Building A Lesson<a class="anchor" aria-label="anchor" href="#building-a-lesson"></a></h2>
<p>Static site generators all know one thing: how to translate markdown to an HTML website. The Carpentries Lesson Infrastructure is no different in that it will generate an HTML website from markdown files using <a href="https://pandoc.org/" class="external-link">pandoc</a>. The difference is how we handle the generated content to make your lesson portable and transferrable.</p>
<div class="section level3">
<h3 id="working-with-generated-content">Working With Generated Content<a class="anchor" aria-label="anchor" href="#working-with-generated-content"></a></h3>
<p><a href="https://software-carpentry.org/blog/2016/07/rmarkdown-new-template.html" class="external-link">The Carpentries has formally supported generated content from R lessons in the form of R Markdown files since 2016</a> and we are working on a solution to incorporate generated content from other languages in the future. If you do not use generated content in your lesson, you can skip this section.</p>
<p>The default paradigm for R Markdown is to first generate markdown output from the R Markdown document, convert it to HTML, and then discard the generated markdown output.</p>
<div class="figure">
<img src="https://github.com/rstudio-education/teaching-in-production/raw/master/slides/images/rmd_flowchart.png" alt="A stylized flowchart with 'good ideas', 'code', and 'data' flowing into '.Rmd', transformed to '.md' via 'knitr', and then transformed to 'html', 'pdf', and 'docx' via 'pandoc'. There is an illustration of a hedgehog knitting a sock to the left and a rabbit wearing the other sock on the right."><p class="caption">Source: “Teaching In Production” by Dr. Allison Horst, <a href="https://rstd.io/tip" class="external-link uri">https://rstd.io/tip</a></p>
</div>
<p>However, this default behavior for generated content is not conducive for collaboration on lessons because the outputs often live in the same place as the source files. Moreover, if any changes occur in the software used to generate content, inspecting the differences between two HTML files is difficult because of markup. We created the {sandpaper} package to alleviate these downsides by clearly separating the generated content from the source material by taking advantage of a two-step model of deployment.</p>
</div>
<div class="section level3">
<h3 id="the-two-step-model-of-deployment">The Two-Step Model of Deployment<a class="anchor" aria-label="anchor" href="#the-two-step-model-of-deployment"></a></h3>
<p>To alleviate the downsides of working with generated content, the new template employs a two-step model of deployment when you run <code><a href="https://rdrr.io/pkg/sandpaper/man/build_lesson.html" class="external-link">sandpaper::build_lesson()</a></code></p>
<ol style="list-style-type: decimal"><li>Take any source files with content that needs to be interpreted (e.g.  R Markdown) and <strong>render them to markdown</strong> in a staging area ignored by git.</li>
<li>Apply the HTML style to the markdown files in the staging area to create the lesson website.</li>
</ol><div class="figure">
<img src="https://zkamvar.github.io/stunning-barnacle/img/local-flow.dot.svg" alt="Diagram showing the process of `build_lesson(rebuild = TRUE)`, starting from R Markdown to Markdown and finally to HTML. R Markdown is highlighted as being the only element tracked by git."><p class="caption">The two-step model of lesson deployment</p>
</div>
<p>All of the generated content lives in the <code>site/</code> folder, and importantly: it is all cached and ignored by git. Ignoring generated content locally means that the source of truth for these files is no longer dependent on the maintainer’s local setup.</p>
<p>The reason we have this model is also for portability. It’s because markdown output is a lot easier to audit than HTML when something goes wrong, rendered markdown can be transferred to other contexts (e.g. books or blogposts), and we can swap out the generators without needing to rewrite the entire pipeline.</p>
<aside class="callout"><div class="section level4">
<h4 id="did-you-know">Did you know?<a class="anchor" aria-label="anchor" href="#did-you-know"></a></h4>
<p>When the lesson is pushed to GitHub, all of the generated content IS stored in separate branches so that we can provide a way for you to audit changes from pull requests.</p>
</div>
</aside></div>
</div>
<div class="section level2">
<h2 id="deploying-on-github">Deploying On GitHub<a class="anchor" aria-label="anchor" href="#deploying-on-github"></a></h2>
<p>For historical reasons, GitHub used the Jekyll static site generator to deploy their documentation websites, but because we no longer use Jekyll, we we deploy our sites in a different manner.</p>
<p>On GitHub, we store generated content in two orphan branches called <code>md-outputs</code> and <code>gh-pages</code> for the generated markdown and html, respectively. We use <a href="https://docs.github.com/en/actions/" class="external-link">GitHub Actions Workflows</a> to build, validate, and deploy our lessons on GitHub pages. Because the markdown and HTML outputs are preserved in the git history, we can tag and preserve them for archiving.</p>
<p>These workflows are the source of truth for the lessons and will keep your lesson up-to-date with the latest version of the HTML template. Moreover, each week, these workflows will check for updates and, if there are any, a pull request will be created to ensure you are using the latest versions. You can <a href="update.html">read more about updating your workflows in the Maitenance chapter</a>.</p>
<p>If you use R Markdown in your lesson, you will notice that for every pull request (PR), a GitHub bot comments on your pull requests informing you about what content has changed and gives you a link to the differences between the current state of the <code>md-outputs</code> branch and the proposed changes. You can find out more about this in the <a href="pull-request.html">Pull Request chapter</a>.</p>
</div>
<div class="section level2 keypoints">
<h2>Keypoints</h2>
<ul><li>Lessons are built using a two-step process of caching markdown outputs and then building HTML from that cache</li>
<li>We use GitHub Actions to deploy and audit generated lesson content to their websites</li>
</ul></div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>


<!-- END:   inst/pkgdown/templates/content-title-body.html-->


      <footer><!-- START: inst/pkgdown/templates/footer.html --><div class="container">
  <div class="row">
    <div class="col-xs-1">
      <h3 class="text-left">
        <a href="example.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      </h3>
    </div>
    <div class="col-xs-10">
      <h3 class="maintitle"><a href="index.html">Introduction to the New Lesson Template</a></h3>
    </div>
    <div class="col-xs-1">
      <h3 class="text-right">
        <a href="update.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      </h3>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
      Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> 2018–2021
      by <a href="https://carpentries.org" class="external-link">The Carpentries</a>
      <br>
      Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> 2016–2018
      by <a href="https://softwarecarpentry.org" class="external-link">Software Carpentry Foundation</a>
    </div>
    <div class="col-md-6 help-links pull-right" align="right">
      <a href="https://github.com/carpentries/sandpaper-docs//edit/main/episodes/deployment.md" data-checker-ignore class="external-link">Edit on GitHub</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//blob/main/CONTRIBUTING.md" data-checker-ignore class="external-link">Contributing</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//" class="external-link">Source</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//blob/main/CITATION" data-checker-ignore class="external-link">Cite</a>
      /
      <a href="mailto:zkamvar@carpentries.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Built with <a href="https://github.com/carpentries/sandpaper" class="external-link">sandpaper (0.0.0.9073)</a>,
      <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.0.0.9033)</a>,
      and <a href="https://github.com/carpentries/varnish" class="external-link">varnish (0.0.0.9008)</a>.
    </div>
  </div>
</div>
<!-- END:   inst/pkgdown/templates/footer.html-->

      </footer></div>

  <!-- START: inst/pkgdown/templates/docsearch.html -->

<!-- END:   inst/pkgdown/templates/docsearch.html-->


  </body></html><!-- END:   inst/pkgdown/templates/layout.html-->

